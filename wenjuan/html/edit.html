<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>两个界面先写在一起</title>
    <link rel='stylesheet' href='../stylesheets/vendor/bootstrap.css' />
    <link rel='stylesheet' href='../stylesheets/vendor/flat-ui.css' />
    <link rel='stylesheet' href='../stylesheets/vendor/font-awesome.css' />
    <link rel='stylesheet' href='../stylesheets/style.css' />
    <script src='../js/vendor/jquery.min.js'></script>
    <script src='../js/vendor/jquery-ui.min.js'></script>
    <style>
        .edit-leftwrapper {float:left;width:168px;}
        .edit-rightwrapper {margin-left:180px;}

        .draggnav, .sortnav{padding-left:0;list-style-type:none;background-color:#eee;}
        .draggnav {padding:10px 20px;}
        .draggnav li>span {display:inline-block;width:20px;margin-right:10px;}
        .sortnav {padding:10px;}

        .action-area>span{cursor:pointer;}
        .img-area {float:left;margin-right:10px;margin-bottom:10px;width:150px;height:170px;border:1px solid #eee;}
        .img-area img{
            width:140px;height:140px;margin:0 auto;
        }
        .img-area .img-radio, .img-area .img-checkbox {
            margin-left:68px;
        }
        .uploader {
            position:relative;
            border:1px dashed #eee;
        }
        .uploader input{position: absolute;
            top: 0;
            right: 0;
            margin: 0;
            width: 100%;
            height: 100%;
            border: solid transparent;
            opacity: .0;
            filter: alpha(opacity= 0);cursor: pointer;}
        .uploader .fui-image {
            position:absolute;
            display:block;width:18px;height:18px;
            left:50%;top:50%;margin-left:-9px;margin-top:-9px;
        }
        
    </style>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="edit-leftwrapper">
            <ul class="draggnav" id="J-draggnav">
                <li data-change="true" data-type="radio"><span class="fui-radio-checked"></span>单选题</li>
                <li data-change="true" data-type="checkbox"><span class="fui-checkbox-checked"></span>多选题</li>
                <li data-change="true" data-type="img-radio"><span class="fui-image"></span>图片单选题</li>
                <li data-change="true" data-type="img-checkbox"><span class="fui-image"></span>图片多选题</li>
                <li data-change="true" data-type="single-input"><span>A</span>单行填空题</li>
                <li data-change="true" data-type="multi-input"><span class="fui-list-columned"></span>多项填空题</li>
                <li data-change="true" data-type="textarea"><span class="fui-folder"></span>多行填空题</li>
                <li data-change="true" data-type="sort"><span class="fui-upload"></span>排序题</li>
                <li data-change="true" data-type="score"><span class="fui-star-2"></span>打分题</li>
                <li data-change="true" data-type="matrix-radio"><span class="fui-list-numbered"></span>矩阵单选题</li>
                <li data-change="true" data-type="matrix-checkbox"><span class="fui-list-numbered"></span>矩阵多选题</li>
                <li data-change="true" data-type="matrix-input"><span class="fui-list-numbered"></span>矩阵填空题</li>
                <li data-change="true" data-type="info"><span class="fui-tag"></span>段落说明</li>
                <li data-change="true" data-type="pagination"><span class="fui-clip"></span>分页</li>
            </ul>

        </div>
        <div class="edit-rightwrapper">
            <div class='panel panel-default'>
                <div class='panel-heading'>
                    <label>标题</label>
                    <input placeholder="填写标题"/>
                </div>
                <div class='panel-body' style="height:100px;">
                    <label>副标题</label>
                    <textarea placeholder="填写标题"></textarea>
                </div>
            </div>
            <ul class="sortnav" id="J-sortarea">

            </ul>
        </div>
    
    </div>
</div>
<script type="text/html" id="M-radio">
    <label class="radio">
        <input type="radio" /><input type="text" placeholder="填写"/>
    </label>
    <label class="radio">
        <input type="radio" /><input type="text" placeholder="填写"/>
    </label>
    <span class="fui-plus-circle"></span>
</script>
<script type="text/html" id="M-checkbox">
    <label class="checkbox">
        <input type="checkbox" /><input type="text" placeholder="填写"/>
    </label>
    <label class="checkbox">
        <input type="checkbox" /><input type="text" placeholder="填写"/>
    </label>
    <span class="fui-plus-circle"></span>
</script>
<script type="text/html" id="M-img-radio">
    <div class="img-area">
        <img src="../images/test/icon_tel.png" width=140 height=140/>
        <input type="radio" class="img-radio"/>
        
    </div>
    <div class="img-area uploader">
        <input type="file" name="files[]" title="点击添加图片"/>
        <span class="fui-image"></span>
    </div>
</script>
<script type="text/html" id="M-img-checkbox">
    <div class="img-area">
        <img src="../images/test/icon_tel.png" width=140 height=140/>
        <input type="checkbox" class="img-radio"/>
        
    </div>
    <div class="img-area uploader">
        <input type="file" name="files[]" title="点击添加图片"/>
        <span class="fui-image"></span>
    </div>
</script>
<script type="text/html" id="M-single-input">
    <input type="text"/ >
</script>
<script type="text/html" id="M-multi-input">
    <label><input placeholder="选项一"</label>
    <input type="text"/ >
    <label><input placeholder="选项二"</label>
    <input type="text"/ >
    <span class="fui-plus-circle"></span>
</script>
<script type="text/html" id="M-textarea">
    <textarea></textarea>
</script>
<script type="text/html" id="M-sort">
    <div class="sort-left">
        <div><input placeholder="选项1"/></div>
        <div><input placeholder="选项2"/></div>
    </div>
    <div class="sort-right">
        <table class="table table-bordered">
            <tbody>
                <tr>
                    <td>1</td>
                    <td>...</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>...</td>
                </tr>
            </tbody>
        </table>
    </div>
</script>
<script type="text/html" id="M-score">
    <div class="score-area">
        <span class="fui-star-2" style="color:grey"></span>
        <span class="fui-star-2" style="color:grey"></span>
        <span class="fui-star-2"></span>
        <span class="fui-star-2"></span>
        <span class="fui-star-2"></span>
    </div>
</script>
<script type="text/html" id="M-matrix-radio">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th></th>
                <th>选项一</th>
                <th>选项二</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>矩阵行一</td>
                <td><input type="radio"/ ></td>
                <td><input type="radio"/ ></td>
            </tr>
            <tr>
                <td>矩阵行一</td>
                <td><input type="radio"/ ></td>
                <td><input type="radio"/ ></td>
            </tr>
        </tbody>
    </table>
</script>
<script type="text/html" id="M-matrix-checkbox">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th></th>
                <th>选项一</th>
                <th>选项二</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>矩阵行一</td>
                <td><input type="checkbox"/ ></td>
                <td><input type="checkbox"/ ></td>
            </tr>
            <tr>
                <td>矩阵行一</td>
                <td><input type="checkbox"/ ></td>
                <td><input type="checkbox"/ ></td>
            </tr>
        </tbody>
    </table>
</script>
<script type="text/html" id="M-matrix-input">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th></th>
                <th>选项一</th>
                <th>选项二</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>矩阵行一</td>
                <td><input type="text"/ ></td>
                <td><input type="text"/ ></td>
            </tr>
            <tr>
                <td>矩阵行一</td>
                <td><input type="text"/ ></td>
                <td><input type="text"/ ></td>
            </tr>
        </tbody>
    </table>
</script>
<script type="text/html" id="M-info">
</script>
<script type="text/html" id="M-pagination">
</script>
<script type="text/html" id="M-pannel">
    <div class='panel panel-default'>
        <div class='panel-heading'>
            <span class="J-order">Q1</span>
            <input placeholder="填写标题"/>
            <div class="fr action-area">
                <span class="fui-triangle-up"></span>    
                <span class="fui-triangle-down"></span>    
                <span class="fui-trash"></span>    
            </div>
        </div>
       <div class='panel-body'>
       </div>
    </div>
</script>

<script>
$(function() {
    $('#J-sortarea').sortable({
        handle: ".panel-heading",
        cursor: "move",
        revert: true
    });
    $('#J-draggnav li').draggable({
        connectToSortable: '#J-sortarea',
        addClasses: false,
        helper: 'clone',
        cursor: "move",
        revert: 'invalid',
        stop: function(event, ui){
            rebuild('#J-sortarea');
        }
    });
    function rebuild(id) {
        console.log($(id).children('li').length);
        $(id).children('li').each(function() {
            if ($(this).attr('data-change') && $(this).attr('data-type')) {
               console.log($(this).attr('data-type')); 
               $(this).attr('data-change', false);
               switchbuild($(this));
            };
        });
    }
    function switchbuild(node) {
        var type = node.attr('data-type');
        var pannel = $($('#M-pannel').html());
        pannel.find('.panel-body').html($('#M-' + type).html());

        node.html('');
        node.append(pannel);
        
        node.css('width', '100%');
        node.css('height', '');
    }
});
</script>
</body>
</html>
